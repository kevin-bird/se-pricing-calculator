<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noimageindex">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="bingbot" content="noindex, nofollow">
    <title>Shocking Energy - Internal Pricing Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: #1a1a1a;
            color: white;
            padding: 20px 0;
            margin-bottom: 40px;
        }

        .header h1 {
            text-align: center;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header .subtitle {
            text-align: center;
            color: #ffeb3b;
            margin-top: 10px;
        }

        .pricing-controls {
            background: #f0f0f0;
            border: 2px dashed #999;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 30px;
            justify-content: flex-start;
            align-items: center;
        }

        .control-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-item label {
            font-weight: bold;
            color: #666;
        }

        .control-item input {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            width: 80px;
            text-align: center;
        }

        .pricing-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .billing-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            gap: 20px;
            align-items: center;
        }

        .pricing-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .pricing-option {
            display: block;
            cursor: pointer;
        }

        .pricing-option input[type="radio"] {
            display: none;
        }

        .option-content {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
            background: white;
        }

        .pricing-option:hover .option-content {
            border-color: #ffeb3b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .pricing-option input[type="radio"]:checked + .option-content {
            border-color: #4CAF50;
            background: #f0f8f0;
        }

        .option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .option-header strong {
            font-size: 1.2em;
        }

        .option-tag {
            background: #ffeb3b;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            color: #333;
        }

        .option-description {
            color: #666;
            font-size: 0.95em;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ccc;
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #4CAF50;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .toggle-switch.active::after {
            transform: translateX(30px);
        }

        .section-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #333;
        }

        .plans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .plan-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .plan-card:hover {
            border-color: #ffeb3b;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .plan-card.selected {
            border-color: #4CAF50;
            background: #f0f8f0;
        }

        .plan-name {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #333;
        }

        .plan-price {
            font-size: 2.2em;
            color: #4CAF50;
            font-weight: bold;
        }

        .plan-price small {
            font-size: 0.4em;
            color: #666;
            font-weight: normal;
        }

        .user-selector {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 40px;
        }

        .user-input-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .user-slider {
            flex: 1;
            max-width: 400px;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            border: none;
        }

        .user-count-display {
            font-size: 2.5em;
            font-weight: bold;
            color: #4CAF50;
            min-width: 100px;
            text-align: center;
        }

        .user-quick-select {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .quick-select-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-select-btn:hover {
            border-color: #4CAF50;
            color: #4CAF50;
        }

        .platform-section {
            margin-top: 40px;
        }

        .platform-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .platform-card {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .platform-card:hover {
            border-color: #ffeb3b;
        }

        .platform-card.selected {
            border-color: #4CAF50;
            background: #f0f8f0;
        }

        .platform-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .platform-description {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .job-tier-selector {
            margin-top: 10px;
        }

        .tier-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .tier-option {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .tier-option:hover {
            border-color: #4CAF50;
        }

        .tier-option.selected {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .tier-cost {
            font-size: 0.8em;
            color: #666;
            margin-top: 2px;
        }

        .tier-option.selected .tier-cost {
            color: rgba(255,255,255,0.9);
        }

        .professional-services {
            margin-top: 40px;
        }

        .service-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .service-card {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .service-card:hover {
            border-color: #ffeb3b;
        }

        .service-card.selected {
            border-color: #4CAF50;
            background: #f0f8f0;
        }

        .service-price {
            font-size: 1.5em;
            color: #4CAF50;
            margin: 10px 0;
            font-weight: bold;
        }

        .service-monthly {
            font-size: 0.9em;
            color: #666;
        }

        .live-price-display {
            position: fixed;
            right: 20px;
            top: 100px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            min-width: 300px;
            max-width: 350px;
            z-index: 1000;
            border: 1px solid #e0e0e0;
        }

        .price-breakdown {
            margin-top: 15px;
        }

        .price-line {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.95em;
        }

        .price-line.total {
            border-bottom: none;
            border-top: 2px solid #333;
            margin-top: 10px;
            padding-top: 15px;
            font-size: 1.3em;
            font-weight: bold;
            color: #4CAF50;
        }

        .price-display-header {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #333;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
        }

        .contract-preview {
            display: none;
            background: #f5f5f5;
            padding: 40px 20px;
            border-radius: 10px;
            margin-top: 40px;
        }

        .contract-section-wrapper {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }

        .contract-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .contract-header h2 {
            color: #1a1a1a;
            margin-bottom: 15px;
        }

        .contract-content {
            line-height: 1.8;
            font-size: 14px;
        }

        .contract-section {
            margin-bottom: 30px;
        }

        .contract-section h3 {
            margin-bottom: 15px;
            color: #333;
        }

        @media (max-width: 1200px) {
            .live-price-display {
                position: relative;
                right: auto;
                top: auto;
                margin-bottom: 30px;
            }
        }

        @media (max-width: 768px) {
            .plans-grid {
                grid-template-columns: 1fr;
            }
            
            .user-input-container {
                flex-direction: column;
            }
            
            .tier-options {
                grid-template-columns: 1fr;
            }

            .pricing-controls {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <script>
        // Simple password protection
        function checkPassword() {
            const password = prompt("Enter password to access the pricing calculator:");
            // Password is base64 encoded: "ShockingEnergy2024"
            const correctPassword = atob("U2hvY2tpbmdFbmVyZ3kyMDI0");
            
            if (password !== correctPassword) {
                alert("Incorrect password. Access denied.");
                document.body.innerHTML = "<h1 style='text-align: center; margin-top: 50px; color: #666;'>Access Denied</h1>";
                return false;
            }
            return true;
        }
        
        // Check password on page load
        if (!checkPassword()) {
            throw new Error("Access denied");
        }
    </script>

    <div class="header">
        <div class="container">
            <h1>Shocking Energy - Internal Pricing Calculator</h1>
            <div class="subtitle">Contract Generator Tool</div>
        </div>
    </div>

    <!-- Live Price Display - Floating -->
    <div class="live-price-display">
        <div class="price-display-header">Live Pricing</div>
        <div class="price-breakdown">
            <div class="price-line">
                <span>User Licenses:</span>
                <span id="userCost">£0</span>
            </div>
            <div class="price-line">
                <span>Platform Fee:</span>
                <span id="platformCost">£0</span>
            </div>
            <div class="price-line">
                <span>Professional Services:</span>
                <span id="serviceCost">£0</span>
            </div>
            <div class="price-line total">
                <span>Total:</span>
                <span id="totalCost">£0</span>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Pricing Controls -->
        <div class="pricing-controls">
            <div class="control-item">
                <label>Premium Monthly User Cost £</label>
                <input type="number" id="advancedMonthly" value="59" min="0" step="1">
            </div>
            <div class="control-item">
                <label>Cost per Job (Monthly) £</label>
                <input type="number" id="baseJobCost" value="5" min="0" step="1">
            </div>
        </div>

        <div class="pricing-section">
            <h2 class="section-title">1. Pricing</h2>
            <div class="pricing-options">
                <label class="pricing-option">
                    <input type="radio" name="pricingModel" value="payg" checked>
                    <div class="option-content">
                        <div class="option-header">
                            <strong>Pay As You Go</strong>
                            <span class="option-tag">No commitment</span>
                        </div>
                        <div class="option-description">Flexible pricing with no minimum commitment</div>
                    </div>
                </label>
                <label class="pricing-option">
                    <input type="radio" name="pricingModel" value="monthly">
                    <div class="option-content">
                        <div class="option-header">
                            <strong>Monthly Contract</strong>
                            <span class="option-tag">Rolling monthly</span>
                        </div>
                        <div class="option-description">20% discount on PAYG rates</div>
                    </div>
                </label>
                <label class="pricing-option">
                    <input type="radio" name="pricingModel" value="annual">
                    <div class="option-content">
                        <div class="option-header">
                            <strong>Annual Contract</strong>
                            <span class="option-tag">Best value</span>
                        </div>
                        <div class="option-description">40% discount on PAYG rates</div>
                    </div>
                </label>
            </div>

            <h2 class="section-title">2. Select Your Plan</h2>
            <div class="plans-grid">
                <div class="plan-card selected" data-plan="standard">
                    <h3 class="plan-name">Standard</h3>
                    <div class="plan-price">
                        £<span class="price-value">40</span><small>/user/month</small>
                    </div>
                </div>

                <div class="plan-card" data-plan="professional">
                    <h3 class="plan-name">Professional</h3>
                    <div class="plan-price">
                        £<span class="price-value">50</span><small>/user/month</small>
                    </div>
                </div>

                <div class="plan-card" data-plan="advanced">
                    <h3 class="plan-name">Premium</h3>
                    <div class="plan-price">
                        £<span class="price-value">59</span><small>/user/month</small>
                    </div>
                </div>
            </div>

            <p style="text-align: center; margin-top: 20px; color: #666; font-style: italic;">*Enterprise pricing is available on request</p>

            <div class="user-selector">
                <h2 class="section-title">3. Number of Users</h2>
                <div class="user-input-container">
                    <div class="user-slider">
                        <input type="range" class="slider" id="userSlider" min="1" max="100" value="5">
                    </div>
                    <div class="user-count-display" id="userCount">5</div>
                </div>
                <div class="user-quick-select">
                    <button class="quick-select-btn" data-users="5">5 users</button>
                    <button class="quick-select-btn" data-users="10">10 users</button>
                    <button class="quick-select-btn" data-users="25">25 users</button>
                    <button class="quick-select-btn" data-users="50">50 users</button>
                    <button class="quick-select-btn" data-users="100">100 users</button>
                </div>
            </div>

            <div class="platform-section">
                <h2 class="section-title">4. Select Your Platform Workflow(s) & Job Volume</h2>
                <p style="margin-bottom: 20px; color: #666;">You can select multiple platforms</p>
                <div class="platform-grid">
                    <div class="platform-card" data-platform="sip">
                        <div class="platform-name">SIP Workflow</div>
                        <div class="platform-description">Safe Isolation Provider workflow with market messages</div>
                        <div class="job-tier-selector">
                            <strong>Select job volume:</strong>
                            <div class="tier-options">
                                <div class="tier-option" data-tier="100">
                                    <div>1-100 jobs</div>
                                    <div class="tier-cost">£9/job</div>
                                </div>
                                <div class="tier-option" data-tier="250">
                                    <div>Up to 250</div>
                                    <div class="tier-cost">£8/job</div>
                                </div>
                                <div class="tier-option" data-tier="500">
                                    <div>Up to 500</div>
                                    <div class="tier-cost">£7/job</div>
                                </div>
                                <div class="tier-option" data-tier="1000">
                                    <div>Up to 1000</div>
                                    <div class="tier-cost">£6/job</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="platform-card" data-platform="solar">
                        <div class="platform-name">Solar Workflow</div>
                        <div class="platform-description">MCS certified solar installation management</div>
                        <div class="job-tier-selector">
                            <strong>Select job volume:</strong>
                            <div class="tier-options">
                                <div class="tier-option" data-tier="100">
                                    <div>1-100 jobs</div>
                                    <div class="tier-cost">£9/job</div>
                                </div>
                                <div class="tier-option" data-tier="250">
                                    <div>Up to 250</div>
                                    <div class="tier-cost">£8/job</div>
                                </div>
                                <div class="tier-option" data-tier="500">
                                    <div>Up to 500</div>
                                    <div class="tier-cost">£7/job</div>
                                </div>
                                <div class="tier-option" data-tier="1000">
                                    <div>Up to 1000</div>
                                    <div class="tier-cost">£6/job</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="platform-card" data-platform="mam">
                        <div class="platform-name">AMR Installs</div>
                        <div class="platform-description">RGMA compliant meter installations</div>
                        <div class="job-tier-selector">
                            <strong>Select job volume:</strong>
                            <div class="tier-options">
                                <div class="tier-option" data-tier="100">
                                    <div>1-100 jobs</div>
                                    <div class="tier-cost">£9/job</div>
                                </div>
                                <div class="tier-option" data-tier="250">
                                    <div>Up to 250</div>
                                    <div class="tier-cost">£8/job</div>
                                </div>
                                <div class="tier-option" data-tier="500">
                                    <div>Up to 500</div>
                                    <div class="tier-cost">£7/job</div>
                                </div>
                                <div class="tier-option" data-tier="1000">
                                    <div>Up to 1000</div>
                                    <div class="tier-cost">£6/job</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="platform-card" data-platform="electrical">
                        <div class="platform-name">Electrical Installation</div>
                        <div class="platform-description">Safety certificates and compliance management</div>
                        <div class="job-tier-selector">
                            <strong>Select job volume:</strong>
                            <div class="tier-options">
                                <div class="tier-option" data-tier="100">
                                    <div>1-100 jobs</div>
                                    <div class="tier-cost">£9/job</div>
                                </div>
                                <div class="tier-option" data-tier="250">
                                    <div>Up to 250</div>
                                    <div class="tier-cost">£8/job</div>
                                </div>
                                <div class="tier-option" data-tier="500">
                                    <div>Up to 500</div>
                                    <div class="tier-cost">£7/job</div>
                                </div>
                                <div class="tier-option" data-tier="1000">
                                    <div>Up to 1000</div>
                                    <div class="tier-cost">£6/job</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="platform-card" data-platform="telecoms">
                        <div class="platform-name">Telecoms Workflow</div>
                        <div class="platform-description">Telecoms installations with SIP integration</div>
                        <div class="job-tier-selector">
                            <strong>Select job volume:</strong>
                            <div class="tier-options">
                                <div class="tier-option" data-tier="100">
                                    <div>1-100 jobs</div>
                                    <div class="tier-cost">£9/job</div>
                                </div>
                                <div class="tier-option" data-tier="250">
                                    <div>Up to 250</div>
                                    <div class="tier-cost">£8/job</div>
                                </div>
                                <div class="tier-option" data-tier="500">
                                    <div>Up to 500</div>
                                    <div class="tier-cost">£7/job</div>
                                </div>
                                <div class="tier-option" data-tier="1000">
                                    <div>Up to 1000</div>
                                    <div class="tier-cost">£6/job</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="platform-card" data-platform="ev">
                        <div class="platform-name">EV Charger Installation</div>
                        <div class="platform-description">Jumptech integrated EV charger workflow with SIP</div>
                        <div class="job-tier-selector">
                            <strong>Select job volume:</strong>
                            <div class="tier-options">
                                <div class="tier-option" data-tier="100">
                                    <div>1-100 jobs</div>
                                    <div class="tier-cost">£9/job</div>
                                </div>
                                <div class="tier-option" data-tier="250">
                                    <div>Up to 250</div>
                                    <div class="tier-cost">£8/job</div>
                                </div>
                                <div class="tier-option" data-tier="500">
                                    <div>Up to 500</div>
                                    <div class="tier-cost">£7/job</div>
                                </div>
                                <div class="tier-option" data-tier="1000">
                                    <div>Up to 1000</div>
                                    <div class="tier-cost">£6/job</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="professional-services">
                <h2 class="section-title">5. SIP Accreditation (Optional)</h2>
                <p>SIP Accreditation Support Services</p>
                
                <div style="text-align: center; margin-bottom: 20px;">
                    <button class="btn" id="sipDiscountBtn" onclick="toggleSipDiscount()" style="background: #ff6b35; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
                        Apply 10% Discount
                    </button>
                </div>
                
                <div class="service-options">
                    <div class="service-card" data-service="upfront" data-months="0">
                        <h4>Up Front</h4>
                        <div class="service-price">
                            <span class="original-price">£15,000</span>
                            <span class="discounted-price" style="display: none;">£13,500</span>
                        </div>
                        <div>Paid upfront</div>
                    </div>
                    <div class="service-card" data-service="three-month" data-months="3">
                        <h4>Flexible</h4>
                        <div class="service-price">
                            <span class="original-price">£5,500</span>
                            <span class="discounted-price" style="display: none;">£4,950</span>
                        </div>
                        <div class="service-monthly">per month for 3 months</div>
                        <div class="service-total">
                            <span class="original-total">Total: £16,500</span>
                            <span class="discounted-total" style="display: none;">Total: £14,850</span>
                        </div>
                    </div>
                    <div class="service-card" data-service="six-month" data-months="6">
                        <h4>Standard</h4>
                        <div class="service-price">
                            <span class="original-price">£3,000</span>
                            <span class="discounted-price" style="display: none;">£2,700</span>
                        </div>
                        <div class="service-monthly">per month for 6 months</div>
                        <div class="service-total">
                            <span class="original-total">Total: £18,000</span>
                            <span class="discounted-total" style="display: none;">Total: £16,200</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Company Details Section -->
            <div class="company-details-section" style="margin-top: 40px;">
                <h2 class="section-title">6. Company Details</h2>
                <p style="margin-bottom: 20px; color: #666;">Enter your company details for the contract</p>
                
                <!-- Company Details Form -->
                <div id="companyDetailsForm" style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Company Name:</label>
                            <input type="text" id="companyName" placeholder="Enter company name" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px;">
                        </div>
                        <div>
                            <button type="button" id="lookupCompany" style="background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin-top: 25px;">
                                Lookup Company Details
                            </button>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Company Number:</label>
                            <input type="text" id="companyNumber" placeholder="Company number (e.g., 12345678)" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">Registered Address:</label>
                            <textarea id="registeredAddress" placeholder="Registered address" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; min-height: 60px; resize: vertical;"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="generateContract()">Generate Contract</button>
                <button class="btn btn-primary" onclick="generateEmail()" style="background: #2196F3;">Generate Email</button>
            </div>
        </div>

        <div class="contract-preview" id="contractPreview">
            <!-- Software as a Service Contract -->
            <div class="contract-section-wrapper">
                <div class="contract-header">
                    <h2>SOFTWARE AS A SERVICE AGREEMENT</h2>
                    <p>THIS AGREEMENT is made on <span class="contractDate"></span> by and between:</p>
                </div>
                
                <div class="contract-content">
                    <div style="margin-bottom: 20px;">
                        <h3>PARTIES:</h3>
                        <ol style="margin-left: 20px;">
                            <li style="margin-bottom: 10px;">
                                <strong>Shocking Energy Limited</strong>, a company incorporated and registered in England and Wales with company number 14657873 whose registered office is at 71-75 Shelton Street, Covent Garden, London, United Kingdom, WC2H 9JQ (hereinafter referred to as "Shocking Energy").
                            </li>
                            <li style="margin-bottom: 10px;">
                                <strong><span class="companyName">[Client Company Name]</span></strong>, a company incorporated and registered in England and Wales with company number <strong><span class="companyNumber">[Company Number]</span></strong> whose registered office is at <strong><span class="registeredAddress">[Registered Address]</span></strong> (hereinafter referred to as "<span class="companyNameShort">[Client]</span>" or "Client").
                            </li>
                        </ol>
                    </div>

                    <div class="contract-section">
                        <h3>BACKGROUND:</h3>
                        <p style="margin-bottom: 10px;">A. Shocking Energy provides software-as-a-service (SAAS) solutions in the energy sector, specialising in workflow management and market messaging services.</p>
                        <p style="margin-bottom: 10px;">B. The Client wishes to utilise Shocking Energy's platform for job management, workflow automation, and industry compliance.</p>
                        <p style="margin-bottom: 10px;">C. The parties acknowledge that the provision of the Services will involve the processing of personal data and that appropriate data protection measures shall be implemented.</p>
                    </div>

                    <p style="margin-top: 20px;"><strong>THEREFORE</strong>, in consideration of the mutual promises and covenants contained herein, the parties hereby agree as follows:</p>

                    <div class="contract-section">
                        <h3>1. SERVICE ENGAGEMENT</h3>
                        <p style="margin-bottom: 10px;">1.1 Shocking Energy shall provide the Client with access to its software platform and related services as described in this Agreement.</p>
                        <p style="margin-bottom: 10px;">1.2 The scope of services is detailed in Schedule 1 of this Agreement.</p>
                        <p style="margin-bottom: 10px;">1.3 The Client agrees to use the services in accordance with the terms and conditions set forth herein.</p>
                    </div>

                    <div class="contract-section">
                        <h3>2. TERM</h3>
                        <p id="saasTerm"></p>
                        <p style="margin-bottom: 10px;">2.2 The Agreement shall automatically renew for successive periods of the same duration unless either party provides written notice of non-renewal at least 30 days before the end of the current term.</p>
                    </div>

                    <div class="contract-section">
                        <h3>3. FEES AND PAYMENT</h3>
                        <div id="saasFees"></div>
                        <p style="margin-bottom: 10px;">3.5 All fees are exclusive of VAT, which shall be added at the prevailing rate.</p>
                        <p style="margin-bottom: 10px;">3.6 Late payments shall incur interest at 2% per month above the Bank of England base rate.</p>
                    </div>

                    <div class="contract-section">
                        <h3>4. SERVICE LEVEL AGREEMENT (SLA)</h3>
                        <h4>4.1 Performance Standards</h4>
                        <p>Shocking Energy commits to:</p>
                        <ul style="margin-left: 20px;">
                            <li>Platform availability of 99.5% measured monthly, excluding scheduled maintenance</li>
                            <li>Maximum response times:
                                <ul>
                                    <li>Priority 1 (Critical): 4 hours</li>
                                    <li>Priority 2 (High): 8 hours</li>
                                    <li>Priority 3 (Medium): 24 hours</li>
                                    <li>Priority 4 (Low): 48 hours</li>
                                </ul>
                            </li>
                            <li>Scheduled maintenance with minimum 72 hours notice</li>
                            <li>Data backup performed daily with 30-day retention</li>
                        </ul>
                        <h4>4.2 Service Credits</h4>
                        <ul style="margin-left: 20px;">
                            <li>For availability below 99.5%: 5% credit of monthly fee</li>
                            <li>For availability below 99%: 10% credit of monthly fee</li>
                            <li>For availability below 95%: 25% credit of monthly fee</li>
                        </ul>
                    </div>

                    <div class="contract-section">
                        <h3>5. PLATFORM ACCESS AND USAGE</h3>
                        <p style="margin-bottom: 10px;">5.1 The Client will have access to the Shocking Energy platform including:</p>
                        <ul style="margin-left: 20px;">
                            <li>Web portal for job management and administration</li>
                            <li>Mobile application for field engineers</li>
                            <li>Selected workflow modules as specified</li>
                            <li>Technical support during business hours</li>
                            <li>API access (where applicable)</li>
                        </ul>
                        <p style="margin-bottom: 10px;">5.2 Access credentials are for the Client's use only and must not be shared with third parties.</p>
                        <p style="margin-bottom: 10px;">5.3 The Client is responsible for all activities conducted under their account.</p>
                    </div>

                    <div class="contract-section">
                        <h3>6. DATA PROTECTION AND SECURITY</h3>
                        <p style="margin-bottom: 10px;">6.1 Both parties agree to comply with all applicable data protection legislation including GDPR.</p>
                        <p style="margin-bottom: 10px;">6.2 Shocking Energy shall implement appropriate technical and organisational measures to protect personal data.</p>
                        <p style="margin-bottom: 10px;">6.3 Data shall be processed solely for the purpose of providing the Services.</p>
                        <p style="margin-bottom: 10px;">6.4 The Client retains ownership of all data uploaded to the platform.</p>
                        <p style="margin-bottom: 10px;">6.5 Upon termination, data will be available for export for 30 days before deletion.</p>
                    </div>

                    <div class="contract-section">
                        <h3>7. INTELLECTUAL PROPERTY</h3>
                        <p style="margin-bottom: 10px;">7.1 Shocking Energy retains all rights, title, and interest in the platform and associated intellectual property.</p>
                        <p style="margin-bottom: 10px;">7.2 The Client is granted a non-exclusive, non-transferable licence to use the platform for the duration of this Agreement.</p>
                        <p style="margin-bottom: 10px;">7.3 The Client retains all rights to their data and any client-specific configurations.</p>
                    </div>

                    <div class="contract-section">
                        <h3>8. SUPPORT AND MAINTENANCE</h3>
                        <p style="margin-bottom: 10px;">8.1 Shocking Energy shall provide:</p>
                        <ul style="margin-left: 20px;">
                            <li>Email support during business hours (9 am–5 pm UK time, Monday–Friday)</li>
                            <li>Regular platform updates and maintenance</li>
                            <li>Access to online documentation and support resources</li>
                            <li>Bug fixes and security patches</li>
                        </ul>
                    </div>

                    <div class="contract-section">
                        <h3>9. CLIENT OBLIGATIONS</h3>
                        <p style="margin-bottom: 10px;">9.1 The Client shall:</p>
                        <ul style="margin-left: 20px;">
                            <li>Provide accurate and complete information</li>
                            <li>Comply with all applicable laws and regulations</li>
                            <li>Not use the platform for any unlawful purpose</li>
                            <li>Maintain the confidentiality of access credentials</li>
                            <li>Report any security breaches or unauthorised access immediately</li>
                        </ul>
                    </div>

                    <div class="contract-section">
                        <h3>10. LIMITATION OF LIABILITY</h3>
                        <p style="margin-bottom: 10px;">10.1 To the fullest extent permitted by law, Shocking Energy's total liability shall not exceed the total amount of fees paid in the twelve months preceding the event giving rise to the liability.</p>
                        <p style="margin-bottom: 10px;">10.2 Neither party shall be liable for any indirect, incidental, or consequential damages.</p>
                        <p style="margin-bottom: 10px;">10.3 Nothing in this Agreement shall limit liability for death or personal injury caused by negligence, fraud, or any other liability that cannot be excluded by law.</p>
                    </div>

                    <div class="contract-section">
                        <h3>11. TERMINATION</h3>
                        <p id="saasTermination"></p>
                        <p style="margin-bottom: 10px;">11.2 Either party may terminate immediately upon material breach by the other party if not remedied within 14 days of written notice.</p>
                        <p style="margin-bottom: 10px;">11.3 Upon termination, all outstanding fees become immediately due and payable.</p>
                        <p style="margin-bottom: 10px;">11.4 The Client's access to the platform will be suspended upon termination.</p>
                    </div>

                    <div class="contract-section">
                        <h3>12. FORCE MAJEURE</h3>
                        <p style="margin-bottom: 10px;">12.1 Neither party shall be liable for any failure or delay caused by circumstances beyond reasonable control, including but not limited to acts of God, war, terrorism, strikes, pandemics, or other events beyond the reasonable control of the affected party.</p>
                    </div>

                    <div class="contract-section">
                        <h3>13. DISPUTE RESOLUTION</h3>
                        <p style="margin-bottom: 10px;">13.1 The parties shall attempt to resolve any disputes through good faith negotiations.</p>
                        <p style="margin-bottom: 10px;">13.2 If unresolved within 30 days, disputes shall be referred to mediation in accordance with the CEDR Model Mediation Procedure.</p>
                        <p style="margin-bottom: 10px;">13.3 If the dispute is not resolved through mediation, either party may commence proceedings in the courts of England and Wales.</p>
                    </div>

                    <div class="contract-section">
                        <h3>14. GENERAL PROVISIONS</h3>
                        <p style="margin-bottom: 10px;">14.1 This Agreement constitutes the entire agreement between the parties.</p>
                        <p style="margin-bottom: 10px;">14.2 Any amendments must be in writing and signed by both parties.</p>
                        <p style="margin-bottom: 10px;">14.3 This Agreement shall be governed by the laws of England and Wales.</p>
                        <p style="margin-bottom: 10px;">14.4 If any provision is found to be invalid, the remaining provisions shall remain in effect.</p>
                    </div>

                    <div class="contract-section" style="page-break-before: always;">
                        <h3>SCHEDULE 1 - SERVICES DESCRIPTION</h3>
                        <div id="saasServicesDetailed"></div>
                    </div>

                    <div class="contract-section" style="margin-top: 60px;">
                        <p><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Agreement as of the date first above written.</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 60px;">
                            <div>
                                <p><strong>For and on behalf of Shocking Energy Limited:</strong></p>
                                <br><br>
                                <p>_________________________________</p>
                                <p>Name: Kevin Bird</p>
                                <p>Title: Director</p>
                                <p>Date: _________________</p>
                                <br>
                                <p><strong>Witness:</strong></p>
                                <br>
                                <p>_________________________________</p>
                                <p>Name: _________________</p>
                                <p>Address: _________________</p>
                                <p>_________________________</p>
                            </div>
                            <div>
                                <p><strong>For and on behalf of <span class="companyName">[Client]</span>:</strong></p>
                                <br><br>
                                <p>_________________________________</p>
                                <p>Name: _________________</p>
                                <p>Title: _________________</p>
                                <p>Date: _________________</p>
                                <br>
                                <p><strong>Witness:</strong></p>
                                <br>
                                <p>_________________________________</p>
                                <p>Name: _________________</p>
                                <p>Address: _________________</p>
                                <p>_________________________</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SIP Accreditation Contract -->
            <div class="contract-section-wrapper" id="sipContract" style="display: none; margin-top: 60px; page-break-before: always;">
                <div class="contract-header">
                    <h2>PROFESSIONAL SERVICES AGREEMENT</h2>
                    <p>FOR SIP ACCREDITATION SUPPORT SERVICES</p>
                    <p>THIS AGREEMENT is made on <span class="contractDate"></span> (the "Effective Date") by and between:</p>
                </div>
                
                <div class="contract-content">
                    <div style="margin-bottom: 20px;">
                        <h3>PARTIES:</h3>
                        <ol style="margin-left: 20px;">
                            <li style="margin-bottom: 10px;">
                                <strong>Shocking Energy Limited</strong>, a company incorporated and registered in England and Wales with company number 14657873 whose registered office is at 71-75 Shelton Street, Covent Garden, London, United Kingdom, WC2H 9JQ (hereinafter referred to as "Shocking Energy" or "Consultant").
                            </li>
                            <li style="margin-bottom: 10px;">
                                <strong><span id="clientCompanyName">[Client Company Name]</span></strong>, a company incorporated and registered in England and Wales with company number <strong><span id="clientCompanyNumber">[Company Number]</span></strong> whose registered office is at <strong><span id="clientRegisteredAddress">[Registered Address]</span></strong> (hereinafter referred to as "<span id="clientCompanyNameShort">[Client]</span>" or "Client").
                            </li>
                        </ol>
                    </div>

                    <div class="contract-section">
                        <h3>BACKGROUND:</h3>
                        <p style="margin-bottom: 10px;">A. Shocking Energy provides professional consultancy services to assist organisations in achieving Safe Isolation Provider (SIP) accreditation and meeting related regulatory requirements of the UK metering industry.</p>
                        <p style="margin-bottom: 10px;">B. <span class="clientCompanyNameShort">[Client]</span> wishes to obtain SIP accreditation and has engaged Shocking Energy to provide professional services to support that objective.</p>
                        <p style="margin-bottom: 10px;">C. The Parties have agreed that Shocking Energy will perform the services set out in Schedule 1 (the "Services") for the fees described in Clause 4.</p>
                        <p style="margin-bottom: 10px;">D. The Parties acknowledge that successful accreditation depends on the Client's implementation of recommended processes and procedures.</p>
                    </div>

                    <p style="margin-top: 20px;"><strong>THEREFORE</strong>, in consideration of the mutual promises and covenants contained herein, the parties hereby agree as follows:</p>

                    <div class="contract-section">
                        <h3>1. ENGAGEMENT OF SERVICES</h3>
                        <p style="margin-bottom: 10px;">1.1 <span class="clientCompanyNameShort">[Client]</span> hereby engages Shocking Energy, and Shocking Energy agrees to provide the Services in accordance with the terms of this Agreement.</p>
                        <p style="margin-bottom: 10px;">1.2 Shocking Energy shall supply all personnel, materials, know-how and expertise reasonably necessary to perform the Services.</p>
                        <p style="margin-bottom: 10px;">1.3 Shocking Energy shall perform the Services with reasonable skill and care and in accordance with good industry practice.</p>
                        <p style="margin-bottom: 10px;">1.4 The Client shall provide timely access to personnel, information, and systems as reasonably required for the performance of the Services.</p>
                    </div>

                    <div class="contract-section">
                        <h3>2. SCOPE OF SERVICES</h3>
                        <p style="margin-bottom: 10px;">2.1 The Services to be provided are detailed in Schedule 1 attached to this Agreement.</p>
                        <p style="margin-bottom: 10px;">2.2 Any services not expressly included in Schedule 1 shall be subject to separate agreement and additional fees.</p>
                        <p style="margin-bottom: 10px;">2.3 Shocking Energy reserves the right to make changes to the Services where necessary to comply with any applicable law or regulatory requirement.</p>
                    </div>

                    <div class="contract-section">
                        <h3>3. TERM</h3>
                        <p id="sipContractTerm">3.1 This Agreement commences on the Effective Date and shall continue for an initial period of 3 calendar months (the "Initial Term").</p>
                        <p style="margin-bottom: 10px;">3.2 Upon expiry of the Initial Term, this Agreement may be extended by mutual written agreement of the Parties.</p>
                        <p style="margin-bottom: 10px;">3.3 Either party may terminate this Agreement with 30 days written notice.</p>
                    </div>

                    <div class="contract-section">
                        <h3>4. FEES AND PAYMENT</h3>
                        <div id="sipContractFees"></div>
                        <p style="margin-bottom: 10px;">4.4 All fees are exclusive of VAT, which shall be added at the prevailing rate.</p>
                        <p style="margin-bottom: 10px;">4.5 Invoices shall be submitted monthly and payment is due within 30 days of the invoice date.</p>
                        <p style="margin-bottom: 10px;">4.6 Late payments shall incur interest at 2% per month above the Bank of England base rate.</p>
                        <p style="margin-bottom: 10px;">4.7 Professional services fees are non-refundable once work has commenced.</p>
                    </div>

                    <div class="contract-section">
                        <h3>5. CLIENT OBLIGATIONS</h3>
                        <p style="margin-bottom: 10px;">5.1 The Client shall:</p>
                        <ul style="margin-left: 20px;">
                            <li>Provide timely access to relevant personnel for meetings and workshops</li>
                            <li>Supply all necessary documentation and information</li>
                            <li>Implement recommended processes and procedures</li>
                            <li>Allocate sufficient resources to achieve accreditation objectives</li>
                            <li>Notify Shocking Energy promptly of any changes that may affect the Services</li>
                        </ul>
                    </div>

                    <div class="contract-section">
                        <h3>6. DELIVERABLES AND MILESTONES</h3>
                        <p style="margin-bottom: 10px;">6.1 Shocking Energy shall provide deliverables in accordance with the timeline set out in Schedule 2.</p>
                        <p style="margin-bottom: 10px;">6.2 The Client shall review and provide feedback on deliverables within 5 working days of receipt.</p>
                        <p style="margin-bottom: 10px;">6.3 Delays caused by the Client may result in adjustment to timelines and additional fees.</p>
                    </div>

                    <div class="contract-section">
                        <h3>7. INTELLECTUAL PROPERTY</h3>
                        <p style="margin-bottom: 10px;">7.1 All intellectual property rights in any materials, documents, methodologies, or processes developed by Shocking Energy in the course of providing the Services shall remain the property of Shocking Energy.</p>
                        <p style="margin-bottom: 10px;">7.2 The Client is granted a non-exclusive, non-transferable licence to use deliverables solely for the purpose of achieving and maintaining SIP accreditation.</p>
                        <p style="margin-bottom: 10px;">7.3 The Client shall not reproduce, distribute, or create derivative works from Shocking Energy's materials without prior written consent.</p>
                    </div>

                    <div class="contract-section">
                        <h3>8. CONFIDENTIALITY</h3>
                        <p style="margin-bottom: 10px;">8.1 Both parties agree to maintain the confidentiality of all proprietary and confidential information disclosed during the performance of this Agreement.</p>
                        <p style="margin-bottom: 10px;">8.2 This obligation shall survive termination of this Agreement for a period of 5 years.</p>
                        <p style="margin-bottom: 10px;">8.3 This clause shall not apply to information that is publicly available or required to be disclosed by law.</p>
                    </div>

                    <div class="contract-section">
                        <h3>9. DATA PROTECTION</h3>
                        <p style="margin-bottom: 10px;">9.1 Both parties shall comply with all applicable data protection legislation including the UK GDPR and Data Protection Act 2018.</p>
                        <p style="margin-bottom: 10px;">9.2 Where personal data is processed, the parties shall enter into appropriate data processing agreements.</p>
                        <p style="margin-bottom: 10px;">9.3 Each party shall implement appropriate technical and organisational measures to protect personal data.</p>
                    </div>

                    <div class="contract-section">
                        <h3>10. LIABILITY AND INDEMNITY</h3>
                        <p style="margin-bottom: 10px;">10.1 Shocking Energy's total liability under this Agreement shall not exceed the total fees paid by the Client in the 12 months preceding the event giving rise to liability.</p>
                        <p style="margin-bottom: 10px;">10.2 Neither party shall be liable for any indirect, incidental, or consequential damages.</p>
                        <p style="margin-bottom: 10px;">10.3 The Client acknowledges that accreditation success depends on their implementation of recommended processes and procedures.</p>
                        <p style="margin-bottom: 10px;">10.4 Nothing in this Agreement shall limit liability for death or personal injury caused by negligence, fraud, or any other liability that cannot be excluded by law.</p>
                    </div>

                    <div class="contract-section">
                        <h3>11. FORCE MAJEURE</h3>
                        <p style="margin-bottom: 10px;">11.1 Neither party shall be liable for any failure or delay caused by circumstances beyond reasonable control, including but not limited to acts of God, war, terrorism, strikes, pandemics, or other events beyond the reasonable control of the affected party.</p>
                        <p style="margin-bottom: 10px;">11.2 The affected party shall notify the other party in writing as soon as possible of the occurrence of a force majeure event.</p>
                    </div>

                    <div class="contract-section">
                        <h3>12. TERMINATION</h3>
                        <p style="margin-bottom: 10px;">12.1 Either party may terminate this Agreement:</p>
                        <ul style="margin-left: 20px;">
                            <li>With 30 days written notice</li>
                            <li>Immediately upon material breach by the other party that is not remedied within 14 days of written notice</li>
                            <li>Immediately if the other party becomes insolvent or ceases trading</li>
                        </ul>
                        <p style="margin-bottom: 10px;">12.2 Upon termination, all outstanding fees become immediately due and payable.</p>
                        <p style="margin-bottom: 10px;">12.3 Termination shall not affect any rights or obligations that have accrued prior to termination.</p>
                    </div>

                    <div class="contract-section">
                        <h3>13. DISPUTE RESOLUTION</h3>
                        <p style="margin-bottom: 10px;">13.1 The parties shall attempt to resolve any disputes through good faith negotiations.</p>
                        <p style="margin-bottom: 10px;">13.2 If unresolved within 30 days, disputes shall be referred to mediation in accordance with the CEDR Model Mediation Procedure.</p>
                        <p style="margin-bottom: 10px;">13.3 If the dispute is not resolved through mediation within 60 days, either party may commence proceedings in the courts of England and Wales.</p>
                    </div>

                    <div class="contract-section">
                        <h3>14. GENERAL PROVISIONS</h3>
                        <p style="margin-bottom: 10px;">14.1 This Agreement constitutes the entire agreement between the parties and supersedes all prior agreements and understandings.</p>
                        <p style="margin-bottom: 10px;">14.2 Any amendments must be in writing and signed by authorised representatives of both parties.</p>
                        <p style="margin-bottom: 10px;">14.3 If any provision is found to be invalid or unenforceable, the remaining provisions shall remain in full force and effect.</p>
                        <p style="margin-bottom: 10px;">14.4 This Agreement shall be governed by the laws of England and Wales.</p>
                        <p style="margin-bottom: 10px;">14.5 Neither party may assign this Agreement without the prior written consent of the other party.</p>
                    </div>

                    <div class="contract-section" style="page-break-before: always;">
                        <h3>SCHEDULE 1 - SERVICES DESCRIPTION</h3>
                        <p style="margin-bottom: 10px;"><strong>SIP Accreditation Support Services</strong></p>
                        <p>Shocking Energy shall provide the following professional services:</p>
                        
                        <h4>1. Initial Assessment and Gap Analysis</h4>
                        <ul style="margin-left: 20px;">
                            <li>Comprehensive review of current processes and procedures</li>
                            <li>Gap analysis against SIP accreditation requirements</li>
                            <li>Risk assessment and mitigation planning</li>
                            <li>Detailed findings report with recommendations</li>
                        </ul>

                        <h4>2. Documentation Development</h4>
                        <ul style="margin-left: 20px;">
                            <li>Creation of required policies and procedures</li>
                            <li>Development of work instructions and process maps</li>
                            <li>Template creation for operational documents</li>
                            <li>Document control system implementation</li>
                        </ul>

                        <h4>3. Process Implementation Support</h4>
                        <ul style="margin-left: 20px;">
                            <li>Process design and optimization</li>
                            <li>Implementation planning and guidance</li>
                            <li>Change management support</li>
                            <li>Operational readiness assessment</li>
                        </ul>

                        <h4>4. Training and Knowledge Transfer</h4>
                        <ul style="margin-left: 20px;">
                            <li>SIP requirements training for key personnel</li>
                            <li>Process and procedure training</li>
                            <li>Internal audit training</li>
                            <li>Provision of training materials</li>
                        </ul>

                        <h4>5. Pre-Audit Support</h4>
                        <ul style="margin-left: 20px;">
                            <li>Mock audits and assessments</li>
                            <li>Corrective action planning</li>
                            <li>Audit preparation workshops</li>
                            <li>Evidence compilation support</li>
                        </ul>

                        <h4>6. Ongoing Support</h4>
                        <ul style="margin-left: 20px;">
                            <li>Weekly progress meetings</li>
                            <li>Email and phone support during business hours</li>
                            <li>Access to SIP documentation library</li>
                            <li>Regulatory update notifications</li>
                        </ul>
                    </div>

                    <div class="contract-section">
                        <h3>SCHEDULE 2 - DELIVERABLES AND TIMELINE</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                            <tr>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f2f2f2;">Deliverable</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f2f2f2;">Timeline</th>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Initial Assessment Report</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">Week 2</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Gap Analysis and Recommendations</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">Week 3</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Policy and Procedure Documentation</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">Week 6</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Training Delivery</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">Week 8</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Mock Audit</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">Week 10</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">Audit Readiness Confirmation</td>
                                <td style="border: 1px solid #ddd; padding: 8px;">Week 12</td>
                            </tr>
                        </table>
                    </div>

                    <div class="contract-section" style="margin-top: 60px;">
                        <p><strong>IN WITNESS WHEREOF</strong>, the parties have executed this Agreement as of the date first above written.</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 60px;">
                            <div>
                                <p><strong>For and on behalf of Shocking Energy Limited:</strong></p>
                                <br><br>
                                <p>_________________________________</p>
                                <p>Name: Kevin Bird</p>
                                <p>Title: Director</p>
                                <p>Date: _________________</p>
                                <br>
                                <p><strong>Witness:</strong></p>
                                <br>
                                <p>_________________________________</p>
                                <p>Name: _________________</p>
                                <p>Address: _________________</p>
                                <p>_________________________</p>
                            </div>
                            <div>
                                <p><strong>For and on behalf of <span class="companyName">[Client]</span>:</strong></p>
                                <br><br>
                                <p>_________________________________</p>
                                <p>Name: _________________</p>
                                <p>Title: _________________</p>
                                <p>Date: _________________</p>
                                <br>
                                <p><strong>Witness:</strong></p>
                                <br>
                                <p>_________________________________</p>
                                <p>Name: _________________</p>
                                <p>Address: _________________</p>
                                <p>_________________________</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Email Template Section -->
    <div class="contract-preview" id="emailPreview" style="display: none;">
        <div class="contract-section-wrapper">
            <div class="contract-header">
                <h2>EMAIL TEMPLATE</h2>
                <p>Copy and paste this email to send to your client</p>
            </div>
            
            <div class="contract-content" style="background: #f5f5f5; padding: 20px; border-radius: 8px;">
                <div style="margin-bottom: 20px;">
                    <strong>To:</strong> <span id="emailClientName">[Client Email]</span><br>
                    <strong>Subject:</strong> Shocking Energy Platform - Proposal and Service Agreement
                </div>
                
                <div id="emailBody" style="white-space: pre-wrap; line-height: 1.6;">
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="copyEmail()">Copy Email to Clipboard</button>
            </div>
        </div>
    </div>

    <script>
        // Base pricing configuration
        const basePricing = {
            baseJobCost: 5,
            advancedMonthly: 35,
            planRatios: {
                standard: 20/35,
                professional: 28/35,
                advanced: 35/35
            },
            discounts: {
                payg: 1,        // No discount
                monthly: 0.8,   // 20% discount
                annual: 0.6     // 40% discount
            },
            services: {
                upfront: { totalCost: 15000, months: 0 },
                'three-month': { monthlyRate: 5500, months: 3 },
                'six-month': { monthlyRate: 3000, months: 6 }
            }
        };

        let selectedPlan = 'standard'; // Default selection
        let selectedPlatforms = {}; // Object to store multiple platform selections
        let selectedService = null;
        let pricingModel = 'payg'; // Default to pay as you go
        let userCount = 5;
        let sipDiscountApplied = false; // Track SIP discount state

        // Calculate dynamic pricing based on controls
        function calculatePlanPrices() {
            const premiumPrice = parseFloat(document.getElementById('advancedMonthly').value) || 59;
            const discount = basePricing.discounts[pricingModel];
            
            // New formula:
            // Professional = Premium - 15%
            // Standard = Professional - 20%
            const premiumFinal = Math.round(premiumPrice * discount);
            const professionalFinal = Math.round(premiumPrice * 0.85 * discount); // 85% of premium
            const standardFinal = Math.round(premiumPrice * 0.85 * 0.8 * discount); // 80% of professional (which is 85% of premium)
            
            return {
                standard: standardFinal,
                professional: professionalFinal,
                advanced: premiumFinal
            };
        }

        // Calculate platform pricing based on tier and base job cost
        function calculatePlatformPrice(tier) {
            const baseJobCost = parseFloat(document.getElementById('baseJobCost').value) || 5;
            const modelDiscount = basePricing.discounts[pricingModel];
            let pricePerJob;
            
            // For Pay As You Go, 1-100 tier uses the exact base job cost
            if (pricingModel === 'payg' && tier === '100') {
                pricePerJob = baseJobCost;
            } else {
                // Apply tier discounts relative to base cost
                switch(tier) {
                    case '100':
                        pricePerJob = baseJobCost; // Base price for 1-100
                        break;
                    case '250':
                        pricePerJob = baseJobCost * 0.9; // 10% discount
                        break;
                    case '500':
                        pricePerJob = baseJobCost * 0.8; // 20% discount
                        break;
                    case '1000':
                        pricePerJob = baseJobCost * 0.7; // 30% discount
                        break;
                    default:
                        pricePerJob = baseJobCost;
                }
                // Apply pricing model discount for contracts
                pricePerJob = pricePerJob * modelDiscount;
            }
            
            return {
                pricePerJob: pricePerJob,
                total: pricePerJob * parseInt(tier)
            };
        }

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Pricing model selection
            document.querySelectorAll('input[name="pricingModel"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    pricingModel = this.value;
                    updatePrices();
                    updateTierPrices();
                    calculateTotal();
                });
            });

            // Pricing control inputs
            document.getElementById('baseJobCost').addEventListener('input', function() {
                updateTierPrices();
                calculateTotal();
            });

            document.getElementById('advancedMonthly').addEventListener('input', function() {
                updatePrices();
                calculateTotal();
            });

            // User slider
            const userSlider = document.getElementById('userSlider');
            userSlider.addEventListener('input', function() {
                userCount = parseInt(this.value);
                document.getElementById('userCount').textContent = userCount;
                calculateTotal();
            });

            // Quick select buttons
            document.querySelectorAll('.quick-select-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    userCount = parseInt(this.dataset.users);
                    document.getElementById('userSlider').value = userCount;
                    document.getElementById('userCount').textContent = userCount;
                    calculateTotal();
                });
            });

            // Plan selection
            document.querySelectorAll('.plan-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedPlan = this.dataset.plan;
                    calculateTotal();
                });
            });

            // Platform selection
            document.querySelectorAll('.platform-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // If clicking on a tier option, don't trigger platform selection
                    if (e.target.classList.contains('tier-option') || e.target.parentElement.classList.contains('tier-option')) return;
                    
                    const platform = this.dataset.platform;
                    
                    // Toggle selection
                    if (this.classList.contains('selected')) {
                        this.classList.remove('selected');
                        delete selectedPlatforms[platform];
                        // Clear tier selections for this platform
                        this.querySelectorAll('.tier-option').forEach(tier => {
                            tier.classList.remove('selected');
                        });
                    } else {
                        this.classList.add('selected');
                        selectedPlatforms[platform] = null; // No tier selected yet
                    }
                    
                    calculateTotal();
                });
            });

            // Tier selection
            document.querySelectorAll('.tier-option').forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    const platformCard = this.closest('.platform-card');
                    const platform = platformCard.dataset.platform;
                    
                    // Make sure platform is selected
                    if (!platformCard.classList.contains('selected')) {
                        platformCard.classList.add('selected');
                    }
                    
                    // Clear other tier selections for this platform
                    platformCard.querySelectorAll('.tier-option').forEach(t => t.classList.remove('selected'));
                    
                    // Select this tier
                    this.classList.add('selected');
                    selectedPlatforms[platform] = this.dataset.tier;
                    
                    calculateTotal();
                });
            });

            // Service selection
            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', function() {
                    // Toggle selection
                    if (this.classList.contains('selected')) {
                        this.classList.remove('selected');
                        selectedService = null;
                    } else {
                        document.querySelectorAll('.service-card').forEach(c => c.classList.remove('selected'));
                        this.classList.add('selected');
                        selectedService = this.dataset.service;
                    }
                    calculateTotal();
                });
            });

            // Company lookup functionality
            document.getElementById('lookupCompany').addEventListener('click', function() {
                const companyName = document.getElementById('companyName').value.trim();
                if (!companyName) {
                    alert('Please enter a company name first');
                    return;
                }
                lookupCompanyDetails(companyName);
            });

            // Set default date
            const contractDateElements = document.querySelectorAll('.contractDate');
            contractDateElements.forEach(element => {
                element.textContent = new Date().toLocaleDateString('en-GB');
            });
            
            // Initial setup
            updatePrices();
            updateTierPrices();
            calculateTotal(); // Calculate initial total on load
        });

        function updatePrices() {
            const prices = calculatePlanPrices();
            
            // Update plan prices display
            document.querySelectorAll('.plan-card').forEach(card => {
                const plan = card.dataset.plan;
                const price = prices[plan];
                card.querySelector('.price-value').textContent = price;
            });
        }

        function updateTierPrices() {
            // Update tier prices display
            document.querySelectorAll('.tier-option').forEach(option => {
                const tier = option.dataset.tier;
                const { pricePerJob } = calculatePlatformPrice(tier);
                option.querySelector('.tier-cost').textContent = `£${pricePerJob.toFixed(2)}/job`;
            });
        }

        function calculateTotal() {
            let userCost = 0;
            let platformCost = 0;
            let serviceCost = 0;
            let serviceMonths = 0;

            const prices = calculatePlanPrices();

            // Calculate user cost
            if (selectedPlan) {
                const prices = calculatePlanPrices();
                const userPrice = prices[selectedPlan];
                userCost = userPrice * userCount;
            }

            // Calculate platform cost (sum of all selected platforms)
            Object.entries(selectedPlatforms).forEach(([platform, tier]) => {
                if (tier) {
                    const { total } = calculatePlatformPrice(tier);
                    platformCost += total;
                }
            });

            // Calculate service cost
            if (selectedService) {
                const service = basePricing.services[selectedService];
                if (service.months === 0) {
                    // Upfront payment
                    serviceCost = service.totalCost;
                } else {
                    // Monthly payment
                    serviceCost = service.monthlyRate;
                    serviceMonths = service.months;
                }
                
                // Apply 10% discount if enabled
                if (sipDiscountApplied) {
                    serviceCost = serviceCost * 0.9;
                }
            }

            // Update display
            const period = pricingModel === 'payg' ? 'month' : (pricingModel === 'monthly' ? 'month' : 'year');
            document.getElementById('userCost').textContent = userCost ? `£${userCost.toLocaleString()}/${period}` : '£0';
            document.getElementById('platformCost').textContent = platformCost ? `£${platformCost.toLocaleString()}/${period}` : '£0';
            
            // Professional services display
            if (serviceCost) {
                if (serviceMonths === 0) {
                    document.getElementById('serviceCost').textContent = `£${serviceCost.toLocaleString()} (upfront)`;
                } else {
                    document.getElementById('serviceCost').textContent = `£${serviceCost.toLocaleString()}/month (${serviceMonths} months)`;
                }
            } else {
                document.getElementById('serviceCost').textContent = '£0';
            }
            
            const recurringTotal = userCost + platformCost;
            let totalDisplay = '£0';
            
            if (recurringTotal > 0 || serviceCost > 0) {
                if (recurringTotal > 0 && serviceCost > 0) {
                    if (serviceMonths === 0) {
                        totalDisplay = `£${recurringTotal.toLocaleString()}/${period}<br>+ £${serviceCost.toLocaleString()} (upfront)`;
                    } else {
                        totalDisplay = `£${recurringTotal.toLocaleString()}/${period}<br>+ £${serviceCost.toLocaleString()}/month (${serviceMonths} months)`;
                    }
                } else if (recurringTotal > 0) {
                    totalDisplay = `£${recurringTotal.toLocaleString()}/${period}`;
                } else {
                    if (serviceMonths === 0) {
                        totalDisplay = `£${serviceCost.toLocaleString()} (upfront)`;
                    } else {
                        totalDisplay = `£${serviceCost.toLocaleString()}/month (${serviceMonths} months)`;
                    }
                }
            }
            
            document.getElementById('totalCost').innerHTML = totalDisplay;
        }

        function generateContract() {
            // Check if we have required selections
            const selectedPlatformsList = Object.entries(selectedPlatforms).filter(([p, tier]) => tier !== null);
            
            if (!selectedPlan || selectedPlatformsList.length === 0) {
                alert('Please select a plan and at least one platform workflow with job volume tier before generating a contract');
                return;
            }

            // Get company details (use defaults if not provided)
            let companyName = '[Your Company]';
            let companyNumber = '[Company Number]';
            let registeredAddress = '[Registered Address]';
            
            // Check if SIP service is selected and company details are provided
            if (selectedService) {
                const enteredName = document.getElementById('companyName').value.trim();
                const enteredNumber = document.getElementById('companyNumber').value.trim();
                const enteredAddress = document.getElementById('registeredAddress').value.trim();
                
                if (!enteredName || !enteredNumber || !enteredAddress) {
                    alert('Please provide complete company details (name, number, and registered address) for the SIP accreditation contract');
                    return;
                }
                
                // Use the entered details
                companyName = enteredName;
                companyNumber = enteredNumber;
                registeredAddress = enteredAddress;
            } else {
                // For SaaS-only contracts, check if any company details were entered
                const enteredName = document.getElementById('companyName').value.trim();
                if (enteredName) {
                    companyName = enteredName;
                    companyNumber = document.getElementById('companyNumber').value.trim() || companyNumber;
                    registeredAddress = document.getElementById('registeredAddress').value.trim() || registeredAddress;
                }
            }

            const prices = calculatePlanPrices();
            const isAnnual = pricingModel === 'annual';
            const period = pricingModel === 'payg' ? 'month' : (pricingModel === 'monthly' ? 'month' : 'year');

            // Always generate SaaS contract with company details
            generateSaaSContract(selectedPlatformsList, prices, isAnnual, period, companyName);

            // Generate SIP contract only if service is selected
            if (selectedService) {
                generateSIPContract();
                document.getElementById('sipContract').style.display = 'block';
            } else {
                document.getElementById('sipContract').style.display = 'none';
            }

            // Show contract preview
            document.getElementById('contractPreview').style.display = 'block';
            document.getElementById('contractPreview').scrollIntoView({ behavior: 'smooth' });
        }

        function generateSaaSContract(selectedPlatformsList, prices, isAnnual, period, companyName) {
            // Update company name in SaaS contract header
            document.querySelectorAll('.companyName').forEach(el => el.textContent = companyName);
            
            // Get company details from form
            const companyNumber = document.getElementById('companyNumber').value.trim() || '[Company Number]';
            const registeredAddress = document.getElementById('registeredAddress').value.trim() || '[Registered Address]';
            
            // Update company details in SaaS contract
            document.querySelectorAll('.companyNumber').forEach(el => el.textContent = companyNumber);
            document.querySelectorAll('.registeredAddress').forEach(el => el.textContent = registeredAddress);
            
            // Set short company name
            const shortName = companyName.split(' ')[0];
            document.querySelectorAll('.companyNameShort').forEach(el => el.textContent = shortName);
            
            // Populate detailed services schedule
            let servicesHTML = '<h4>Platform Access and Services</h4>';
            servicesHTML += '<p>The Client shall have access to the following services:</p>';
            servicesHTML += '<ol style="margin-left: 20px;">';
            
            // Add user plan details
            servicesHTML += `<li><strong>${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)} User Plan</strong><br>`;
            servicesHTML += `<ul style="margin-left: 20px;">`;
            servicesHTML += `<li>${userCount} user licenses with full platform access</li>`;
            servicesHTML += `<li>Web portal for job management and administration</li>`;
            servicesHTML += `<li>Mobile application access for field engineers</li>`;
            servicesHTML += `<li>Real-time job tracking and reporting</li>`;
            servicesHTML += `<li>Document management and storage</li>`;
            servicesHTML += `</ul></li>`;
            
            // Add platform-specific services
            selectedPlatformsList.forEach(([platform, tier]) => {
                const platformName = document.querySelector(`[data-platform="${platform}"] .platform-name`).textContent;
                const platformDesc = document.querySelector(`[data-platform="${platform}"] .platform-description`).textContent;
                servicesHTML += `<li style="margin-top: 10px;"><strong>${platformName}</strong><br>`;
                servicesHTML += `<ul style="margin-left: 20px;">`;
                servicesHTML += `<li>${platformDesc}</li>`;
                servicesHTML += `<li>Up to ${tier} jobs per month</li>`;
                servicesHTML += `<li>Automated workflow management</li>`;
                servicesHTML += `<li>Compliance tracking and reporting</li>`;
                servicesHTML += `</ul></li>`;
            });
            
            servicesHTML += '</ol>';
            
            servicesHTML += '<h4 style="margin-top: 20px;">Support Services</h4>';
            servicesHTML += '<ul style="margin-left: 20px;">';
            servicesHTML += '<li>Email support during business hours (9 am–5 pm UK time)</li>';
            servicesHTML += '<li>Access to knowledge base and documentation</li>';
            servicesHTML += '<li>Regular platform updates and enhancements</li>';
            servicesHTML += '<li>Monthly usage reports</li>';
            servicesHTML += '</ul>';
            
            document.getElementById('saasServicesDetailed').innerHTML = servicesHTML;
            
            // Set SaaS term
            const saasTerm = isAnnual ? 
                '2.1 This agreement commences on the date above and continues for an initial period of 12 months.' :
                '2.1 This agreement commences on the date above and continues on a rolling monthly basis.';
            document.getElementById('saasTerm').textContent = saasTerm;

            // Set SaaS fees (excluding professional services)
            const userPrice = prices[selectedPlan];
            
            let saasFeesHTML = `
                <p><strong>3.1 Monthly Recurring Charges:</strong></p>
                <p>User Licenses: £${userPrice} per user per ${period} x ${userCount} users = £${(userPrice * userCount).toLocaleString()} per ${period}</p>
            `;
            
            // Add platform fees
            let totalPlatformCost = 0;
            selectedPlatformsList.forEach(([platform, tier]) => {
                const { pricePerJob, total: platformCost } = calculatePlatformPrice(tier);
                totalPlatformCost += platformCost;
                const platformName = document.querySelector(`[data-platform="${platform}"] .platform-name`).textContent;
                saasFeesHTML += `<p>${platformName}: Up to ${tier} jobs per month at £${pricePerJob.toFixed(2)} per job = £${platformCost.toLocaleString()} per ${period}</p>`;
            });

            const totalSaaSCost = (userPrice * userCount) + totalPlatformCost;
            saasFeesHTML += `<p><strong>3.2 Total Monthly SaaS Fee: £${totalSaaSCost.toLocaleString()} per ${period}</strong></p>`;
            
            // Add billing frequency note
            if (pricingModel === 'payg') {
                saasFeesHTML += `<p>3.3 Billing: Monthly in arrears based on actual usage.</p>`;
            } else if (pricingModel === 'monthly') {
                saasFeesHTML += `<p>3.3 Billing: Monthly in advance (20% discount applied).</p>`;
            } else if (pricingModel === 'annual') {
                saasFeesHTML += `<p>3.3 Billing: Annual in advance (40% discount applied).</p>`;
                saasFeesHTML += `<p><strong>Annual Total: £${(totalSaaSCost * 12).toLocaleString()}</strong></p>`;
            }
            
            saasFeesHTML += `<p>3.4 Payment terms: Net 30 days from invoice date.</p>`;
            
            // Add overage rates for contracted customers
            if (pricingModel !== 'payg') {
                const paygPrices = calculatePlanPrices();
                // Reset discount to PAYG rates
                const originalDiscount = basePricing.discounts[pricingModel];
                basePricing.discounts[pricingModel] = 1;
                const paygUserPrice = calculatePlanPrices()[selectedPlan];
                basePricing.discounts[pricingModel] = originalDiscount;
                
                saasFeesHTML += `<h4>3.5 Additional Usage (Overage) Rates</h4>`;
                saasFeesHTML += `<p>Usage exceeding subscribed limits will be charged at current Pay As You Go rates:</p>`;
                saasFeesHTML += `<ul style="margin-left: 20px;">`;
                saasFeesHTML += `<li>Additional users: £${paygUserPrice}/user/month</li>`;
                
                // Calculate PAYG job rates for each selected platform
                selectedPlatformsList.forEach(([platform, tier]) => {
                    const platformName = document.querySelector(`[data-platform="${platform}"] .platform-name`).textContent;
                    const baseJobCost = parseFloat(document.getElementById('baseJobCost').value) || 5;
                    saasFeesHTML += `<li>${platformName} jobs exceeding ${tier}/month: £${baseJobCost.toFixed(2)}/job</li>`;
                });
                
                saasFeesHTML += `</ul>`;
            }

            document.getElementById('saasFees').innerHTML = saasFeesHTML;

            // Set SaaS termination clause
            const saasTermination = isAnnual ? 
                '11.1 Either party may terminate this agreement with 30 days written notice at the end of the initial 12-month term. Early termination fees may apply.' :
                '11.1 Either party may terminate this agreement with 30 days written notice.';
            document.getElementById('saasTermination').textContent = saasTermination;
        }

        function generateSIPContract() {
            const service = basePricing.services[selectedService];
            
            // Get company details
            const companyName = document.getElementById('companyName').value.trim() || '[Client Company Name]';
            const companyNumber = document.getElementById('companyNumber').value.trim() || '[Company Number]';
            const registeredAddress = document.getElementById('registeredAddress').value.trim() || '[Registered Address]';
            
            // Populate company details in contract
            document.querySelectorAll('#clientCompanyName').forEach(el => el.textContent = companyName);
            document.querySelectorAll('#clientCompanyNumber').forEach(el => el.textContent = companyNumber);
            document.querySelectorAll('#clientRegisteredAddress').forEach(el => el.textContent = registeredAddress);
            
            // Set short company name (first word or full name if single word)
            const shortName = companyName.split(' ')[0];
            document.querySelectorAll('#clientCompanyNameShort, .clientCompanyNameShort').forEach(el => {
                el.textContent = shortName;
            });
            
            // Set contract term based on service type
            let termText = '';
            let feesHTML = '';
            
            // Apply discount if enabled
            const discountMultiplier = sipDiscountApplied ? 0.9 : 1;
            const discountText = sipDiscountApplied ? ' (10% discount applied)' : '';
            
            switch(selectedService) {
                case 'upfront':
                    termText = '3.1 This Agreement commences on the Effective Date and shall continue for an initial period of 12 months (the "Initial Term").';
                    const upfrontCost = Math.round(service.totalCost * discountMultiplier);
                    feesHTML = `
                        <p><strong>4.1 Professional Services Fee:</strong></p>
                        <p>The total fee for the Services is £${upfrontCost.toLocaleString()}${discountText}, payable in full upon execution of this Agreement.</p>
                        <p><strong>4.2 Payment Terms:</strong> Payment is due within 7 days of the Effective Date.</p>
                        <p><strong>4.3 Coverage:</strong> This fee covers all accreditation support services for a period of up to 12 months from the Effective Date.</p>
                    `;
                    break;
                case 'three-month':
                    termText = '3.1 This Agreement commences on the Effective Date and shall continue for an initial period of 3 calendar months (the "Initial Term").';
                    const threeMonthRate = Math.round(service.monthlyRate * discountMultiplier);
                    const threeMonthTotal = threeMonthRate * service.months;
                    feesHTML = `
                        <p><strong>4.1 Professional Services Fee:</strong></p>
                        <p>The monthly fee for the Services is £${threeMonthRate.toLocaleString()} per month${discountText}.</p>
                        <p><strong>4.2 Total Program Cost:</strong> £${threeMonthTotal.toLocaleString()} over ${service.months} months.</p>
                        <p><strong>4.3 Payment Terms:</strong> Monthly fees are payable in advance by the first day of each calendar month. The first payment is due within 7 days of the Effective Date.</p>
                    `;
                    break;
                case 'six-month':
                    termText = '3.1 This Agreement commences on the Effective Date and shall continue for an initial period of 6 calendar months (the "Initial Term").';
                    const sixMonthRate = Math.round(service.monthlyRate * discountMultiplier);
                    const sixMonthTotal = sixMonthRate * service.months;
                    feesHTML = `
                        <p><strong>4.1 Professional Services Fee:</strong></p>
                        <p>The monthly fee for the Services is £${sixMonthRate.toLocaleString()} per month${discountText}.</p>
                        <p><strong>4.2 Total Program Cost:</strong> £${sixMonthTotal.toLocaleString()} over ${service.months} months.</p>
                        <p><strong>4.3 Payment Terms:</strong> Monthly fees are payable in advance by the first day of each calendar month. The first payment is due within 7 days of the Effective Date.</p>
                    `;
                    break;
            }

            document.getElementById('sipContractTerm').textContent = termText;
            document.getElementById('sipContractFees').innerHTML = feesHTML;
        }

        // Company lookup function using Companies House API
        async function lookupCompanyDetails(companyName) {
            try {
                // Show loading state
                const button = document.getElementById('lookupCompany');
                const originalText = button.textContent;
                button.textContent = 'Looking up...';
                button.disabled = true;

                // For security reasons, the Companies House API cannot be called directly from the browser
                // This would require a backend service to handle the API key securely
                
                // Simulate a delay to show the loading state
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Since this is a static site, provide a helpful message
                alert('Company lookup is currently unavailable on the static site version.\n\n' +
                      'Please enter the company details manually:\n' +
                      '• Company Name\n' +
                      '• Company Number\n' +
                      '• Registered Address\n\n' +
                      'You can find these details at:\n' +
                      'https://find-and-update.company-information.service.gov.uk/');
                      
            } catch (error) {
                console.error('Company lookup error:', error);
                alert('Company lookup failed. Please enter details manually.');
            } finally {
                // Reset button state
                const button = document.getElementById('lookupCompany');
                button.textContent = originalText;
                button.disabled = false;
            }
        }

        function toggleSipDiscount() {
            const btn = document.getElementById('sipDiscountBtn');
            const originalPrices = document.querySelectorAll('.original-price');
            const discountedPrices = document.querySelectorAll('.discounted-price');
            const originalTotals = document.querySelectorAll('.original-total');
            const discountedTotals = document.querySelectorAll('.discounted-total');

            sipDiscountApplied = !sipDiscountApplied;

            if (sipDiscountApplied) {
                // Show discounted prices, hide original
                originalPrices.forEach(price => price.style.display = 'none');
                discountedPrices.forEach(price => price.style.display = 'inline');
                originalTotals.forEach(total => total.style.display = 'none');
                discountedTotals.forEach(total => total.style.display = 'inline');
                btn.textContent = 'Remove 10% Discount';
                btn.style.background = '#28a745';
            } else {
                // Show original prices, hide discounted
                originalPrices.forEach(price => price.style.display = 'inline');
                discountedPrices.forEach(price => price.style.display = 'none');
                originalTotals.forEach(total => total.style.display = 'inline');
                discountedTotals.forEach(total => total.style.display = 'none');
                btn.textContent = 'Apply 10% Discount';
                btn.style.background = '#ff6b35';
            }

            // Recalculate total to reflect discount
            calculateTotal();
        }

        function generateEmail() {
            const selectedPlatformsList = Object.entries(selectedPlatforms).filter(([p, tier]) => tier !== null);
            
            if (!selectedPlan || selectedPlatformsList.length === 0) {
                alert('Please select a plan and at least one platform workflow with job volume tier before generating an email');
                return;
            }

            const companyName = document.getElementById('companyName').value.trim() || '[Company Name]';
            const prices = calculatePlanPrices();
            const userPrice = prices[selectedPlan];
            const period = pricingModel === 'payg' ? 'month' : (pricingModel === 'monthly' ? 'month' : 'year');
            
            // Calculate total costs
            let totalPlatformCost = 0;
            selectedPlatformsList.forEach(([platform, tier]) => {
                const { total: platformCost } = calculatePlatformPrice(tier);
                totalPlatformCost += platformCost;
            });
            
            const totalSaaSCost = (userPrice * userCount) + totalPlatformCost;
            
            // Build email content
            let emailContent = `Dear ${companyName} Team,

Thank you for your interest in the Shocking Energy platform. Following our discussions, I'm pleased to provide you with a comprehensive proposal for our software services${selectedService ? ' and SIP accreditation support' : ''}.

PROPOSED SOLUTION OVERVIEW
========================

We recommend the following configuration for your organisation:

SOFTWARE PLATFORM
-----------------
• Plan: ${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)} Plan
• Users: ${userCount} licenses
• Billing: ${pricingModel === 'payg' ? 'Pay As You Go' : pricingModel === 'monthly' ? 'Monthly Contract (20% discount)' : 'Annual Contract (40% discount)'}

SELECTED WORKFLOWS
------------------`;

            selectedPlatformsList.forEach(([platform, tier]) => {
                const platformName = document.querySelector(`[data-platform="${platform}"] .platform-name`).textContent;
                const platformDesc = document.querySelector(`[data-platform="${platform}"] .platform-description`).textContent;
                const { pricePerJob } = calculatePlatformPrice(tier);
                emailContent += `\n• ${platformName} (Up to ${tier} jobs/month at £${pricePerJob.toFixed(2)}/job)\n  - ${platformDesc}`;
            });

            emailContent += `\n\nPRICING SUMMARY
===============
User Licenses: £${(userPrice * userCount).toLocaleString()}/${period}`;

            selectedPlatformsList.forEach(([platform, tier]) => {
                const platformName = document.querySelector(`[data-platform="${platform}"] .platform-name`).textContent;
                const { total: platformCost } = calculatePlatformPrice(tier);
                emailContent += `\n${platformName}: £${platformCost.toLocaleString()}/${period}`;
            });

            emailContent += `\n\nTotal Monthly Platform Fee: £${totalSaaSCost.toLocaleString()}/${period}`;
            
            if (pricingModel === 'annual') {
                emailContent += `\nTotal Annual Cost: £${(totalSaaSCost * 12).toLocaleString()}`;
            }

            // Add SIP accreditation if selected
            if (selectedService) {
                const service = basePricing.services[selectedService];
                const discountMultiplier = sipDiscountApplied ? 0.9 : 1;
                const discountText = sipDiscountApplied ? ' (10% discount applied)' : '';
                
                emailContent += `\n\nSIP ACCREDITATION SUPPORT
=========================`;
                
                if (selectedService === 'upfront') {
                    const cost = Math.round(service.totalCost * discountMultiplier);
                    emailContent += `\nOne-time fee: £${cost.toLocaleString()}${discountText}`;
                } else {
                    const monthlyRate = Math.round(service.monthlyRate * discountMultiplier);
                    const total = monthlyRate * service.months;
                    emailContent += `\n${service.months}-month programme: £${monthlyRate.toLocaleString()}/month${discountText}`;
                    emailContent += `\nTotal cost: £${total.toLocaleString()}`;
                }
                
                emailContent += `\n\nThis comprehensive support package includes:
• Initial assessment and gap analysis
• Documentation development and review
• Process implementation support
• Training for key personnel
• Mock audits and preparation
• Ongoing support throughout the accreditation process`;
            }

            emailContent += `\n\nKEY BENEFITS
============
• Industry-leading platform for job management and compliance
• Real-time visibility of all operations
• Mobile app for field engineers
• Automated workflow management
• Comprehensive reporting and analytics
• UK-based support team
• Regular platform updates and enhancements

NEXT STEPS
==========
1. Review the attached contract(s)
2. Sign and return the agreements
3. We'll schedule your onboarding session
4. Platform access will be provided within 24 hours

I've attached the formal agreement(s) for your review. Please don't hesitate to contact me if you have any questions or would like to discuss any aspect of this proposal.

I look forward to welcoming ${companyName} to the Shocking Energy platform and supporting your operational excellence.

Best regards,

[Your Name]
[Your Title]
Shocking Energy Limited
Email: [Your Email]
Phone: [Your Phone]
Web: www.shockingenergy.com`;

            // Update email preview
            document.getElementById('emailClientName').textContent = companyName;
            document.getElementById('emailBody').textContent = emailContent;
            
            // Show email preview
            document.getElementById('emailPreview').style.display = 'block';
            document.getElementById('emailPreview').scrollIntoView({ behavior: 'smooth' });
        }

        function copyEmail() {
            const emailContent = document.getElementById('emailBody').textContent;
            
            // Create a temporary textarea to copy the content
            const textarea = document.createElement('textarea');
            textarea.value = emailContent;
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
                alert('Email copied to clipboard!');
            } catch (err) {
                alert('Failed to copy email. Please select and copy manually.');
            }
            
            document.body.removeChild(textarea);
        }
    </script>
</body>
</html>